function btvs(){return Math.random()}function getPointNum(s){if(s)return s>=1?s.toFixed(2):s.toFixed(8)}function trades(s,a){var l={sell:{html:"",sn:1e3},buy:{html:"",sum:0,sn:1e3}};$.getJSON(WebHelper.QueryTrades+"?id="+s+"&t="+btvs(),function(s){for(var i=s.data,e=[],d=0,t=0,n=0;n<l.sell.sn;n++)void 0!==i.sell[n]&&(e[n]=d+=i.sell[n].fleftCount,t+=parseFloat(i.sell[n].fleftCount));for(n=l.sell.sn-1;n>=0;n--)if(void 0!==i.sell[n]){var o=100*(i.sell[n].fleftCount/t).toFixed(2);l.sell.html+='<dd  onclick="autotrust(this,\'sell\')"> <div  class="sidebar_bg_red" style="width: '+o+'%"></div> <div class="w_33t red">'+lang("卖")+(n+1)+'</div> <div class="w_33p is_num"  >'+i.sell[n].fprize+'</div> <div class="w_33p is_num" data-point="'+pointData(a,"numberPre")+'">'+i.sell[n].fleftCount+'</div></div> <div style="display: none;" class="w_80">'+formatfloat(i.sell[n].fleftCount*i.sell[n].fprize,4,0)+"</div> </dd>"}var r=0;$("#orderbook-sell").html(l.sell.html);for(n=0;n<l.buy.sn;n++)void 0!==i.buy[n]&&(r+=parseFloat(i.buy[n].fleftCount));$("#orderbook-sell").scrollTop($("#orderbook-sell")[0].scrollHeight),d=0;for(n=0;n<l.buy.sn;n++)if(void 0!==i.buy[n]){l.buy.sum=FF.add(l.buy.sum,i.buy[n].fleftCount),d+=i.buy[n].fleftCount;o=100*(i.buy[n].fleftCount/r).toFixed(2);l.buy.html+='<dd onclick="autotrust(this,\'buy\')"> <div class="sidebar_bg_green" style="width: '+o+'%"></div><div class="w_33t green">'+lang("买")+(n+1)+'</div> <div class="w_33p is_num"  >'+i.buy[n].fprize+'</div> <div class="w_33p is_num" data-point="'+pointData(a,"numberPre")+'">'+i.buy[n].fleftCount+'</div></div> <div class="w_80" style="display: none;">'+formatfloat(i.buy[n].fleftCount*i.buy[n].fprize,4,0)+"</div> </dd>"}$("#orderbook-buy").html(l.buy.html),goods_num(),setTimeout("trades(3)",5e3)})}function setTab2(s,a,l){for(i=1;i<=l;i++){var e=document.getElementById(s+i),d=document.getElementById("con_"+s+"_"+i);e.className=i==a?"hover":"",d.style.display=i==a?"block":"none"}}function accAdd(s,a){var l,i,e,d;try{l=s.toString().split(".")[1].length}catch(s){l=0}try{i=a.toString().split(".")[1].length}catch(s){i=0}if(d=Math.abs(l-i),e=Math.pow(10,Math.max(l,i)),d>0){var t=Math.pow(10,d);l>i?(s=Number(s.toString().replace(".","")),a=Number(a.toString().replace(".",""))*t):(s=Number(s.toString().replace(".",""))*t,a=Number(a.toString().replace(".","")))}else s=Number(s.toString().replace(".","")),a=Number(a.toString().replace(".",""));return(s+a)/e}function tradesWs(){new WebSocket(WsApi.designatesApi+$.cookie("USER").split(",")[0]).onmessage=function(s){var a=JSON.parse(s.data);if(1==a.status){for(var l=a.data,i=0;i<l.length;i++)renderMarketBox(l[i]);goods_num()}}}function renderMarketBox(s){var a="",l=s.trade.name,i=s.trade,e=i.increase>0?"green":0==i.increase?"":"red";0==$("#orderbook-sell"+i.id).length&&(a+='<div class="market_my_entrust clearBoth" id="market_my_entrust'+i.id+'"><div class="coin_trade clearBoth"><div class="finddeal_currency"><i class="coin coin_40 coin_'+l.toLowerCase()+'_40"></i><span><span class="coin-name">'+l+'</span><span>/</span><span class="">'+i.area+'</span></span></div><div><p class="coinPrice is_num '+e+'">'+i.LatestDealPrize+'</p><p class="fabi"><span>≈</span><span class="coinPriceFabi">'+i[getLang_rate()]+'</span><span class="fabiName">'+getLang_rate()+'</span></p></div></div><div class="book-sell"><dl class="sidebar-dl"><dt><div class="w_55"><span>'+lang("卖")+'</span></div><div class="w_95"><span>'+lang("价格")+"</span>(<span>"+i.area+'</span>)</div><div class="w_100"><span>'+lang("数量")+'</span></div><div class="w_100"><span>'+lang("总计")+'</span></div><div class="w_100"><span>'+lang("委托价格")+'</span></div><div class="w_100"><span>'+lang("委托数量")+'</span></div></dt><div class="listscoll" id="orderbook-sell'+i.id+'"></div></dl></div><div class="book-sell"><dl class="sidebar-dl"><dt><div class="w_55"><span>'+lang("买")+'</span></div><div class="w_95"><span>'+lang("价格")+"</span>(<span>"+i.area+'</span>)</div><div class="w_100"><span>'+lang("数量")+'</span></div><div class="w_100"><span>'+lang("总计")+'</span></div><div class="w_100"><span>'+lang("委托价格")+'</span></div><div class="w_100"><span>'+lang("委托数量")+'</span></div></dt><div class="listscoll book-buy sidebar-dl" id="orderbook-buy'+i.id+'"></div></dl></div></div>',$("#all_coin"+s.trade.areaId).append(a)),randerTrade({name:l.toLowerCase(),id:i.id,decimalDigits:i.decimalDigits,decimalNum:i.decimalNum,areaId:i.areaId},s.entrustInfo)}function randerTrade(s,a){for(var l={sell:{html:"",sn:1e3},buy:{html:"",sum:0,sn:1e3}},i=0,e=a.sellFentrustHistory,d=0;d<a.sell.length;d++){void 0!==a.sell[d]&&(i+=parseFloat(a.sell[d][1]));for(var t=0;t<e.length;t++)a.sell[d][0]==e[t][0]&&(a.sell[d]=a.sell[d].concat(e[t]))}for(d=0;d<l.sell.sn;d++)if(void 0!==a.sell[d]){var n=1==a.sell[d][2]?"bg_yellow":"bg_white",o=100*(a.sell[d][1]/i).toFixed(2);l.sell.html+='<dd class="'+n+'"> <div  class="sidebar_bg_red" style="width: '+o+'%"></div> <div class="w_55 red">'+lang("卖")+(d+1)+'</div> <div class="w_95 is_num" data-point="'+s.decimalDigits+'">'+a.sell[d][0]+'</div> <div class="w_100 is_num" data-point="'+s.decimalNum+'">'+a.sell[d][1]+'</div> <div class="w_100 is_num" data-point="'+s.decimalNum+'">'+a.sell[d][3]+'</div> <div class="w_100 is_num" data-point="'+s.decimalDigits+'">'+(a.sell[d][4]?a.sell[d][4]:"")+'</div><div class="w_100 is_num" data-point="'+s.decimalNum+'">'+(a.sell[d][5]?a.sell[d][5]:"")+"</div></dd>"}$("#orderbook-sell"+s.id).html(l.sell.html);var r=0,u=a.buyFentrustHistory;for(d=0;d<a.buy.length;d++)if(void 0!==a.buy[d]){r+=parseFloat(a.buy[d][1]);for(t=0;t<u.length;t++)a.buy[d][0]==u[t][0]&&(a.buy[d]=a.buy[d].concat(u[t]))}vol=0;for(d=0;d<l.buy.sn;d++)if(void 0!==a.buy[d]){l.buy.sum=FF.add(l.buy.sum,a.buy[d][1]),vol+=a.buy[d][1];var c=1==a.buy[d][2]?"bg_yellow":"bg_white";o=100*(a.buy[d][1]/r).toFixed(2);l.buy.html+='<dd class="'+c+'"> <div class="sidebar_bg_green" style="width: '+o+'%"></div><div class="w_55 green">'+lang("买")+(d+1)+'</div> <div class="w_95 is_num" data-point="'+s.decimalDigits+'">'+a.buy[d][0]+'</div> <div class="w_100 is_num" data-point="'+s.decimalNum+'">'+a.buy[d][1]+'</div> <div class="w_100 is_num" data-point="'+s.decimalNum+'">'+a.buy[d][3]+'</div> <div class="w_100 is_num" data-point="'+s.decimalDigits+'">'+(a.buy[d][4]?a.buy[d][4]:"")+'</div><div class="w_100 is_num" data-point="'+s.decimalNum+'">'+(a.buy[d][5]?a.buy[d][5]:"")+"</div></dd>"}$("#orderbook-buy"+s.id).html(l.buy.html)}tradesWs();