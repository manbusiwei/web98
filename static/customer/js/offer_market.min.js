function btvs(){return Math.random()}function getPointNum(e){if(e)return 1<=e?e.toFixed(2):e.toFixed(8)}function trades(e,r){var o={sell:{html:"",sn:1e3},buy:{html:"",sum:0,sn:1e3}};$.getJSON(WebHelper.QueryTrades+"?id="+e+"&t="+btvs(),function(e){for(var s=e.data,l=[],a=0,i=0,t=0;t<o.sell.sn;t++)void 0!==s.sell[t]&&(l[t]=a+=s.sell[t].fleftCount,i+=parseFloat(s.sell[t].fleftCount));for(t=o.sell.sn-1;0<=t;t--)if(void 0!==s.sell[t]){var d=100*(s.sell[t].fleftCount/i).toFixed(2);o.sell.html+='<dd  onclick="autotrust(this,\'sell\')"> <div  class="sidebar_bg_red" style="width: '+d+'%"></div> <div class="w_33t red">'+lang("卖")+(t+1)+'</div> <div class="w_33p is_num"  >'+s.sell[t].fprize+'</div> <div class="w_33p is_num" data-point="'+pointData(r,"numberPre")+'">'+s.sell[t].fleftCount+'</div></div> <div style="display: none;" class="w_80">'+formatfloat(s.sell[t].fleftCount*s.sell[t].fprize,4,0)+"</div> </dd>"}var n=0;$("#orderbook-sell").html(o.sell.html);for(t=0;t<o.buy.sn;t++)void 0!==s.buy[t]&&(n+=parseFloat(s.buy[t].fleftCount));$("#orderbook-sell").scrollTop($("#orderbook-sell")[0].scrollHeight);for(t=a=0;t<o.buy.sn;t++)if(void 0!==s.buy[t]){o.buy.sum=FF.add(o.buy.sum,s.buy[t].fleftCount),a+=s.buy[t].fleftCount;d=100*(s.buy[t].fleftCount/n).toFixed(2);o.buy.html+='<dd onclick="autotrust(this,\'buy\')"> <div class="sidebar_bg_green" style="width: '+d+'%"></div><div class="w_33t green">'+lang("买")+(t+1)+'</div> <div class="w_33p is_num"  >'+s.buy[t].fprize+'</div> <div class="w_33p is_num" data-point="'+pointData(r,"numberPre")+'">'+s.buy[t].fleftCount+'</div></div> <div class="w_80" style="display: none;">'+formatfloat(s.buy[t].fleftCount*s.buy[t].fprize,4,0)+"</div> </dd>"}$("#orderbook-buy").html(o.buy.html),goods_num(),setTimeout("trades(3)",5e3)})}function setTab2(e,s,l){for(i=1;i<=l;i++){var a=document.getElementById(e+i),t=document.getElementById("con_"+e+"_"+i);a.className=i==s?"hover":"",t.style.display=i==s?"block":"none"}}function accAdd(e,s){var l,a,i,t;try{l=e.toString().split(".")[1].length}catch(e){l=0}try{a=s.toString().split(".")[1].length}catch(e){a=0}if(t=Math.abs(l-a),i=Math.pow(10,Math.max(l,a)),0<t){var d=Math.pow(10,t);a<l?(e=Number(e.toString().replace(".","")),s=Number(s.toString().replace(".",""))*d):(e=Number(e.toString().replace(".",""))*d,s=Number(s.toString().replace(".","")))}else e=Number(e.toString().replace(".","")),s=Number(s.toString().replace(".",""));return(e+s)/i}function tradesWs(){new WebSocket(WsApi.designatesApi+$.cookie("USER").split(",")[0]).onmessage=function(e){var s=JSON.parse(e.data);if(1==s.status){for(var l=s.data,a=$(".market_type .active").data("cointype"),i=0;i<l.length;i++)a==l[i].trade.areaId&&renderMarketBox(l[i]);goods_num()}}}function renderMarketBox(e){var s="",l=e.trade.name,a=e.trade,i=0<a.increase?"green":0==a.increase?"":"red";0==$("#orderbook-sell"+a.id).length&&(s+='<div class="market_my_entrust clearBoth" id="market_my_entrust'+a.id+'"><div class="coin_trade clearBoth"><div class="finddeal_currency"><i class="coin coin_40 coin_'+l.toLowerCase()+'_40"></i><span><span class="coin-name">'+l+'</span><span>/</span><span class="">'+a.area+'</span></span></div><div><p class="coinPrice is_num '+i+'">'+a.LatestDealPrize+'</p><p class="fabi"><span>≈</span><span class="coinPriceFabi">'+a[getLang_rate()]+'</span><span class="fabiName">'+getLang_rate()+'</span></p></div></div><div class="book-sell"><dl class="sidebar-dl"><dt><div class="w_55"><span>'+lang("卖/买")+'</span></div><div class="w_95"><span>'+lang("价格")+"</span>(<span>"+a.area+'</span>)</div><div class="w_100"><span>'+lang("数量")+'</span></div><div class="w_100"><span>'+lang("总计")+'</span></div></dt><div class="listscoll" id="orderbook-sell'+a.id+'"></div><div class="listscoll book-buy sidebar-dl" id="orderbook-buy'+a.id+'"></div></dl></div></div>',$("#all_coin"+e.trade.areaId).append(s)),randerTrade({name:l.toLowerCase(),id:a.id,decimalDigits:a.decimalDigits,decimalNum:a.decimalNum,areaId:a.areaId},e.entrustInfo)}function randerTrade(e,s){for(var l=$("#orderbook-sell"+e.id),a=$("#orderbook-buy"+e.id),i={sell:{html:"",sn:1e3},buy:{html:"",sum:0,sn:1e3}},t=[],d=0,n=0,r=0;r<i.sell.sn;r++)void 0!==s.sell[r]&&(t[r]=d+=s.sell[r][1],n+=parseFloat(s.sell[r][1]));for(r=i.sell.sn-1;0<=r;r--)if(void 0!==s.sell[r]){var o=1==s.sell[r][2]?"bg_yellow":"bg_white",u=100*(s.sell[r][1]/n).toFixed(2);i.sell.html+='<dd class="'+o+'"> <div  class="sidebar_bg_red" style="width: '+u+'%"></div> <div class="w_55 red">'+lang("卖")+(r+1)+'</div> <div class="w_95 is_num"  >'+s.sell[r][0]+'</div> <div class="w_100 is_num" data-point="'+e.decimalNum+'">'+s.sell[r][1]+'</div> <div class="w_100 is_num" data-point="'+e.decimalNum+'">'+s.sell[r][3]+"</div> </dd>"}var c=0;l.html(i.sell.html);for(r=0;r<i.buy.sn;r++)void 0!==s.buy[r]&&(c+=parseFloat(s.buy[r][1]));$("#orderbook-sell"+e.id).scrollTop($("#orderbook-sell"+e.id)[0].scrollHeight);for(r=d=0;r<i.buy.sn;r++)if(void 0!==s.buy[r]){i.buy.sum=FF.add(i.buy.sum,s.buy[r][1]),d+=s.buy[r][1];var v=1==s.buy[r][2]?"bg_yellow":"bg_white";u=100*(s.buy[r][1]/c).toFixed(2);i.buy.html+='<dd class="'+v+'"> <div class="sidebar_bg_green" style="width: '+u+'%"></div><div class="w_55 green">'+lang("买")+(r+1)+'</div> <div class="w_95 is_num"  >'+s.buy[r][0]+'</div> <div class="w_100 is_num" data-point="'+e.decimalNum+'">'+s.buy[r][1]+'</div> <div class="w_100 is_num" data-point="'+e.decimalNum+'">'+s.buy[r][3]+"</div> </dd>"}a.html(i.buy.html)}tradesWs();