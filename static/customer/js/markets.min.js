var priceTmp={btc:[],eth:[],favorite:[]},isAllFavoriteData=0,favoriteHtml="";function get_data(){$.each(allMarkets,function(a,t){getMarketData(a)}),USER&&$.get(WebHelper.queryOptionalRealTime,function(a){1==a.status?(priceTmp.favorite=a.data,renderPage(priceTmp.favorite,"favorite")):(favoriteHtml="",priceTmp.favorite=[],isAllFavoriteData=0)})}function getMarketData(t){$.get(WebHelper.queryRealTime+"?coinType="+t+"&t="+Math.random(),function(a){1==a.status?(priceTmp[allMarkets[t]]=a.data,renderPage(priceTmp[allMarkets[t]],t)):console.log("交易页列表操作失败,类型:"+t)})}function renderPage(a,t){isAllFavoriteData+=1;var e="",i=JSON.parse(localStorage.getItem("favorite")||"{}");i[allMarkets[t]]||(i[allMarkets[t]]={},localStorage.setItem("favorite",JSON.stringify(i)));for(var r=0;r<a.length;r++){var o=a[r].C||t,l=allMarkets[o],s=a[r].N.toLowerCase(),c=a[r].ID,n=0==parseFloat(a[r].I)?"":parseFloat(a[r].I)<0?"red":"green",d=0<parseFloat(a[r].I)?"+":"",p=1==a[r].O?"active":USER||i[allMarkets[o]][s]!=c?"":"active";e+='<li data-favoritecoin="'+c+'"><i data-coinType="'+o+'" class="isFavorite '+p+'" data-coinId="'+c+'" data-coinName="'+s+'"></i><dl style="zoom:1" class="autobox clear"><a data-coinType="'+o+'" href="/trade/coinTrade.html?id='+c+"&shortName="+s+"&coinType="+o+'"><dt style="width:115px"><em class="coin coin_19 coin_'+s+'_19"></em><p>'+s.toUpperCase()+"/"+l.toUpperCase()+'</p></dt><dd class="is_num '+n+'" data-point="'+a[r].DD+'">'+a[r].LDP+'</dd><dd style="width:60px;text-align:right" class="'+n+'">'+d+a[r].I+'%</dd><div class="clear"></div></a></dl></li>',USER||i[allMarkets[o]][s]==c&&(priceTmp.favorite.push(a[r]),favoriteHtml+='<li data-favoritecoin="'+c+'"><i data-coinType="'+o+'" class="isFavorite '+p+'" data-coinId="'+c+'" data-coinName="'+s+'"></i><dl style="zoom:1" class="autobox clear"><a data-coinType="'+o+'" href="/trade/coinTrade.html?id='+c+"&shortName="+s+"&coinType="+o+'"><dt style="width:115px"><em class="coin coin_19 coin_'+s+'_19"></em><p>'+s.toUpperCase()+"/"+l.toUpperCase()+'</p></dt><dd class="is_num '+n+'" data-point="'+a[r].DD+'">'+a[r].LatestDealPrize+'</dd><dd style="width:60px;text-align:right" class="'+n+'">'+d+a[r].I+'%</dd><div class="clear"></div></a></dl></li>')}"favorite"==t?$(".show_favorite_data").html(e):$(".show_"+(allMarkets[t]?allMarkets[t]:t).toUpperCase()+"_data").html(e),USER||isAllFavoriteData>=Object.getOwnPropertyNames(i).length&&$(".show_favorite_data").html(favoriteHtml),goods_num()}function sortcoinList(a,t){return new Function("a","b",'return parseFloat(a["'+t+'"])'+(1==a?">":"<")+'parseFloat(b["'+t+'"])? 1:-1')}function rd(){return Math.random()}setInterval(function(){get_data()},1e5);var sort_hTol=0,sortBy="";$(function(){get_data(),$(".price_today_ull > .click-sort").each(function(){$(this).click(function(){if(0==$(this).find(".active").length?$(this).find(".cagret-up").addClass("active"):$(this).find(".cagret").toggleClass("active"),sort_hTol=0==sort_hTol?1:0,sortBy=$(this).data("sort"))for(var a in priceTmp){for(var t in allMarkets)allMarkets[t]==a&&t;priceTmp[a].sort(sortcoinList(sort_hTol,sortBy))}})})});